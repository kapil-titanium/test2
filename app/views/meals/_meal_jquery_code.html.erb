<script>
$(document).ready(function(){

//Validation for meal creation
    $('#meal_submit').click(function(){
    	  if($('#menu').val() == ""){
    	  	alert('Please select Menu');
    	  	return false;
    	  }
    	  if($('#sub_menu').val() == ""){
            alert('Please select Sub Menu');
            return false;
          }
          var flagValidate = true;
          $('.course').each(function(){
            var min_qty = parseInt($(this).children('.minimum_qty').html());
            var max_qty = parseInt($(this).children('.maximum_qty').html());
            var courseId = parseInt($(this).children('.course_id').html()); 
            var selectedDishesCount = 0 ;
            if( jQuery.isEmptyObject($('#course_dishes_'+ courseId.toString()).val()) ){
            }else{
               selectedDishesCount = $('#course_dishes_' + courseId.toString() ).val().length;
            }
            if(selectedDishesCount < min_qty){
              alert('Please select minimum '+min_qty);
              flagValidate = false;
              return false;
            }
            if(selectedDishesCount > max_qty){
              alert('Please select maximum '+max_qty);
              flagValidate = false;
              return false;
            }
          });
          if(!flagValidate){
            return false;  
          }
 // for meal Price validations
          kitchenPrice = parseFloat($("#kitchen_price").val());
          rcPriceRangeMin = parseFloat($("#rc_price_range_min").html());
          rcPriceRangeMax = parseFloat($("#rc_price_range_max").html());
          if(kitchenPrice < rcPriceRangeMin || kitchenPrice > rcPriceRangeMax ){
          	alert("Price must be in range of " + rcPriceRangeMin + " to " + rcPriceRangeMax);
          	return false;
          }
// End of meal price validations
 // for meal Capacity validations  
          minCapacity = parseFloat($("#meal_min_capacity").val());
          maxCapacity = parseFloat($("#meal_max_capacity").val());
          if(minCapacity > maxCapacity ){
              alert('Minimm capacity should be less than maximum capacity');
              return false;
          } 
// End of meal Capacity validations
          
       });
 // end of validation
 
//Menu selection 
	$("#menu").change(function() {
			var selectedMenu = $(this).val();
			slectedText = $(this).find('option:selected').text();
			// to make serving size readonly for dinner menu 
			if(slectedText == '<%= MENU_NAME_DINNER %>'){
				$('#serving_size').val('<%= DEFAULT_SERVING_SIZE %>');
				$('#serving_size').attr('readonly', true);
			}else{
				$('#serving_size').val('');
				$('#serving_size').attr('readonly', false);
			}
			// end 
			// to make min-capacity and max-capacity readonly and according to menu
			if(slectedText == '<%= MENU_NAME_DINNER %>'){
				$('#meal_min_capacity').val('<%= MENU_DINNER_LOWER_LIMIT %>');
				$('#meal_max_capacity').val('<%= MENU_DINNER_UPPER_LIMIT %>');
			}else{
				'<% min, max = get_party_min_max_serving_size current_user.is_kitchen? ? current_user.kitchen.id  : (current_user.is_employee? ? params[:kitchen_id] : nil) %>'
				$('#meal_min_capacity').val('<%= min %>');
				$('#meal_max_capacity').val('<%= max %>');
			}
							
			//end 
			if (selectedMenu == "") {
				selectedMenu = 0;
			}
			$.ajax({
				async : true,
				type : 'GET',
				url : "/meals/get_sub_menus/" + selectedMenu,
				success : function(data) {
					$('#sub_menu_div').html(data);
					if(selectedMenu == 0 || ($('#sub_menu').val() == "")){
						$('#display_dishes_div').hide('slow');
					}else{
						$('#display_dishes_div').show('slow');
					}			
				},
				error : function(data) {
				}
			});
			
		});
//End        

});
</script>