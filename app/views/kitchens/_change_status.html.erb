<script>
    // $(function() {
        // $('#tblKitchens').dataTable({
            // "aaSorting": [],
            // "bJQueryUI" : true,
            // "bPaginate" : true
        // });
    // }); 
    
    function validateFieldsToSubmit(current, kitchenId){
        if( $(current).parents("#tr_kitchen_" + kitchenId).find("#comment_field").val().trim() == "" ){
            alert('Please mention Comment to Submit');
            return false;
        }
        return true;
    }
</script>
<% if kitchens.present? %>
<table width="100%" border="0" cellspacing="0" cellpadding="2" style="background:#fef7ea;"> <!-- id="tblKitchens" class="dataTable" -->
    <tr style="background:#900; color:#fff; text-align:left;">
        <th style="width: 125px;">Kitchen</th>
        <th style="width: 100px;">City</th>
        <th style="width: 125px;">Promoter</th>
        <th style="width: 50px;">Contact</th>
        <th style="width: 50px;">Status</th>
        <th style="text-align: center;">Action</th>
    </tr>
    <% kitchens.each do |k| %>
    <tr class="gradeA" id="tr_kitchen_<%= k.id %>" style="border-bottom:1px solid #900;">
        <td><%= link_to k.kitchen_name, kitchen_path(k) %></td>
        <td><%= k.user.addresses.first.city %></td>          
        <td><%= k.primary_contact_name %></td>
        <td><%= k.primary_contact_number %></td>            
        <td><%= k.status.titleize %></td>
        <td>
            <% if (active_cities.nil?) || (!(active_cities.nil?) &&(active_cities.include?(k.user.addresses.first.city.downcase))) %>
                <%= form_tag kitchens_change_status_path(k), :id => "index_form"  do %>
                    <%= hidden_field_tag :id, k.id %>
                    <%= text_field_tag :status_comment, k.status_comment, :class => 'index_amt_field', :style=>'width: 200px; display: block;', :placeholder => "write status comments",:id=>'comment_field' %>
                    <% if k.status.casecmp(KITCHEN_STATUS_NEW) == 0 || k.status.casecmp(KITCHEN_STATUS_REJECTED) == 0 %>
                        <% btn = KITCHEN_BUTTON_APPROVE %>
                    <% elsif k.status.casecmp(KITCHEN_STATUS_APPROVED) == 0 %>
                        <% btn = KITCHEN_BUTTON_ACTIVATE %>
                    <!-- < % elsif k.status.casecmp(KITCHEN_STATUS_ACTIVATED) == 0 % >
                        < % btn = KITCHEN_BUTTON_SUSPEND % > -->
                    <% elsif k.status.casecmp(KITCHEN_STATUS_SUSPENDED) == 0 %>
                        <% btn = KITCHEN_BUTTON_ACTIVATE %>
                    <% end %>
                    
                    <% if k.status.casecmp(KITCHEN_STATUS_ACTIVATED) != 0 %>
                      <%= submit_tag btn, :class => 'btn btn-small btn-success', :style => 'margin-top: -10px;'%>
                    <% end %>
                    <% if (k.status.casecmp(KITCHEN_STATUS_APPROVED) != 0) && (k.status.casecmp(KITCHEN_STATUS_ACTIVATED) != 0) && (k.status.casecmp(KITCHEN_STATUS_REJECTED) != 0)  %>                 
                        <%= submit_tag KITCHEN_BUTTON_REJECT, :class => 'btn btn-danger btn-small',:style => 'margin-top: -10px;' %>
                    <% end %>
                    <% if (k.status.casecmp(KITCHEN_STATUS_APPROVED) == 0) || (k.status.casecmp(KITCHEN_STATUS_ACTIVATED) == 0) %>                   
                        <%= submit_tag KITCHEN_BUTTON_SUSPEND, :class => 'btn btn-danger btn-small',:style => 'margin-top: -10px;' %>
                    <% end %>                   
                    <% if k.status.casecmp(KITCHEN_STATUS_NEW) == 0 ||  k.status.casecmp(KITCHEN_STATUS_APPROVED) == 0 %>
                        <%=submit_tag KITCHEN_BUTTON_SUBMIT,:class => 'btn btn-small',:style=> 'margin-top: -10px;',:onclick => "return validateFieldsToSubmit(this, #{k.id})" %>
                    <%end%>
                    
                <% end %>
            <% end %>
        </td>
    </tr>
    <% end %>
</table>
<% else %>
<div>
    No Order available
</div>
<% end %>
